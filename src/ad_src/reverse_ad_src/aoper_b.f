C        Generated by TAPENADE     (INRIA, Ecuador team)
C  Tapenade 3.16 (develop) - 15 Jan 2021 14:26
C
C  Differentiation of get_res in reverse (adjoint) mode (with options i4 dr8 r8):
C   gradient     of useful results: alfa beta vinf xyzref mach
C                rv1 rv2 rc gam res
C   with respect to varying inputs: ysym zsym alfa beta vinf xyzref
C                mach rv1 rv2 rc chordv enc gam res
C   RW status of diff variables: ysym:out zsym:out alfa:incr beta:incr
C                vinf:in-out xyzref:incr mach:incr rv1:incr rv2:incr
C                rc:incr chordv:out enc:out gam:incr res:in-zero
Csubroutine solve_rhs
      SUBROUTINE GET_RES_B()
      INCLUDE 'AVL.INC'
      INCLUDE 'AVL_ad_seeds.inc'
      INTEGER i
      INTEGER ii1
C---  
      CALL PUSHREAL8ARRAY(wc_gam, 3*nvmax**2)
      CALL BUILD_AIC()
C---- set VINF() vector from initial ALFA,BETA
      CALL VINFAB()
C
      DO ii1=1,nvmax
        rhs_diff(ii1) = 0.D0
      ENDDO
      DO i=nvor,1,-1
        rhs_diff(i) = rhs_diff(i) - res_diff(i)
      ENDDO
      CALL MAT_PROD_B(aicn, aicn_diff, gam, gam_diff, nvor, res, 
     +                res_diff)
      DO ii1=1,6000
        res_diff(ii1) = 0.D0
      ENDDO
      CALL SET_VEL_RHS_B()
      CALL VINFAB_B()
      CALL POPREAL8ARRAY(wc_gam, 3*nvmax**2)
      CALL BUILD_AIC_B()
      END


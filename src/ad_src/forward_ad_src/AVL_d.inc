C        Generated by TAPENADE     (INRIA, Ecuador team)
C  Tapenade 3.16 (develop) - 15 Jan 2021 14:26
C
      INCLUDE 'AINDEX_d.inc'
      INTEGER nvmax
      INTEGER numax
      INTEGER nsmax
      INTEGER ndmax
      INTEGER nfmax
      INTEGER nbmax
      INTEGER ngmax
      INTEGER iconx
      INTEGER nrmax
      INTEGER ibx
      INTEGER nlmax
      INTEGER ntmax
      PARAMETER (nvmax=6000, nsmax=400, nfmax=30, nlmax=500, nbmax=20, 
     +   numax=6, ndmax=30, ngmax=20, nrmax=25, ntmax=5000, ibx=300, 
     +   iconx=20)
      INTEGER icmax
      INTEGER itmax
      INTEGER ivmax
      INTEGER ipmax
      INTEGER jemax
      PARAMETER (itmax=2*nvmax, ivmax=ivtot+ndmax, icmax=ictot+ndmax, 
     +   ipmax=iptot, jemax=jetot)
C
C
C---- unit values, names, and namelengths
      CHARACTER*32 unchl, unchm, uncht, unchf, unchs, unchv, uncha, 
     +             unchi, unchd
      REAL unita
      REAL unitd
      REAL unitf
      REAL uniti
      REAL unitl
      REAL unitm
      REAL units
      REAL unitt
      REAL unitv
      COMMON /un_r/ unitl, unitm, unitt, unitf, units, unitv, unita, 
     +uniti, unitd
      COMMON /un_c/ unchl, unchm, uncht, unchf, unchs, unchv, uncha, 
     +unchi, unchd
      INTEGER nua
      INTEGER nud
      INTEGER nuf
      INTEGER nui
      INTEGER nul
      INTEGER num
      INTEGER nus
      INTEGER nut
      INTEGER nuv
      COMMON /un_i/ nul, num, nut, nuf, nus, nuv, nua, nui, nud
C
      REAL mach, mach0
C
      CHARACTER*80 frndef, fprdef, fevdef
      CHARACTER*80 title
      CHARACTER*40 stitle, btitle, rtitle
      CHARACTER*16 dname, gname
      CHARACTER*12 varnam, connam
      CHARACTER*12 varkey
      CHARACTER*3 conkey
      CHARACTER*10 parnam
      CHARACTER*32 parunch
C default run case save file
C default dimensional parameter file
C default eigenvalue save file
C configuration title
C surface title
C body title
C run case title
C control variable name
C design  variable name
C variable   name
C constraint name
C variable   selection key
C constraint selection key
C run case parameter name
C run case parameter unit name
      COMMON /case_c/ frndef, fprdef, fevdef, title, stitle(nfmax), 
     +btitle(nbmax), rtitle(nrmax), dname(ndmax), gname(ngmax), varnam(
     +ivmax), connam(icmax), varkey(ivmax), conkey(icmax), parnam(ipmax)
     +, parunch(ipmax)
      INTEGER nrun
      INTEGER nstrip
      INTEGER lurun
      INTEGER neigen
      INTEGER nbody
      INTEGER lustd
      INTEGER irune
      INTEGER luout
      INTEGER matsym
      INTEGER nptot
      INTEGER irunt
      INTEGER luinp
      INTEGER icon
      INTEGER irun
      INTEGER nsurf
      INTEGER nitmax
      INTEGER nctot
      REAL cpscl
      INTEGER ncontrol
      INTEGER nvor
      INTEGER nlnode
      INTEGER itrim
      INTEGER nvtot
      INTEGER izsym
      INTEGER neigendat
      INTEGER iysym
      INTEGER ndesign
      INTEGER lusys
C
C logical unit for configuration file
C logical unit for run case file
C logical unit for output dump file
C logical unit for stability deriv. dump file
C logical unit for dynamic system matrix dump file
C y,z image symm.  (0=no image, 1=image)
C matrix symmetry flag
C number of horseshoe vortices
C number of chordwise strips
C number of surfaces
C number of body source+doublet line nodes
C number of bodies
C index of constraint for each variable
C total number of available variables
C total number of available constraints
C total number of available parameters
C number of control variables
C number of design variables
C max number of Newton iterations
C current run case, number of run cases stored
C target run case for eigenmode calculations
C target run case for time march initial state
C trim type used for run case (if any)
C number of valid eigenmodes available for run case
C number reference data eigenvalues
C CP scaling factor for cp plot
      COMMON /case_i/ luinp, lurun, luout, lustd, lusys, iysym, izsym, 
     +matsym, nvor, nstrip, nsurf, nlnode, nbody, icon(ivmax, nrmax), 
     +nvtot, nctot, nptot, ncontrol, ndesign, nitmax, irun, nrun, irune
     +, irunt, itrim(nrmax), neigen(nrmax), neigendat(nrmax), cpscl
C
      LOGICAL lgeo, lenc, laic, lsrd, lvel, lsol, lsen, lvisc, lmass, 
     +        lcondef, ldesdef, lptot, lpsurf, lpstrp, lpele, lphinge, 
     +        lpderiv, lbforce, lnasa_sa, lsa_rates, lmwait, lverbose
      LOGICAL lppar
C T if geometry exists
C T if all normal vectors are valid
C T if AIC matrix has been generated
C T if unit source+doublet strengths are computed
C T if induced velocity matrix has been computed
C T if valid solution exists
C T if valid sensitivities exist
C T if viscous profile drag terms are to be added
C T if mass data has been read in
C T if control variable has been declared
C T if design  variable has been declared
C T if total   forces are to be printed
C T if surface forces are to be printed
C T if strip   forces are to be printed
C T if element forces are to be printed
C T if hinge moments are to be printed
C T if stability and control derivs are to be printed
C T if body forces are to be included in total forces
C T if NASA-std stability axes are to be used
C T if stability-axis rates are to be used
C T if mode display is to wait for real time
C T if parameter value is to be plotted
C debug flag to trigger writing out typical avl output
      COMMON /case_l/ lgeo, lenc, laic, lsrd, lvel, lsol, lsen, lvisc, 
     +lmass, lcondef(ndmax), ldesdef(ngmax), lptot, lpsurf, lpstrp, 
     +lpele, lphinge, lpderiv, lbforce, lnasa_sa, lsa_rates, lmwait, 
     +lppar(ipmax), lverbose
      REAL cztot_u
      REAL vinf_a
      REAL cdff_d
      REAL xyzref0
      REAL vinf_b
      REAL cdff_g
      REAL bref
      REAL conval
      REAL spanef_u
      REAL dtr
      REAL cdtot
      REAL cztot
      REAL cdff_u
      REAL cmtot_d
      REAL cntot
      REAL cmtot_g
      REAL cytot
      REAL cdvtot
      REAL version
      REAL cnsax
      REAL cmtot
      REAL vrcore
      REAL cytot_d
      REAL cxtot
      REAL cytot_g
      REAL cmtot_u
      REAL cmsax
      REAL cltot
      REAL parval
      REAL wrot
      REAL xnp
      REAL cyff_d
      REAL delcon
      REAL cyff_g
      REAL cytot_u
      REAL dcm_a0
      REAL sref
      REAL cyff
      REAL xyzref
      REAL vinf
      REAL cdtot_a
      REAL cyff_u
      REAL dcl_a0
      REAL cdtot_d
      REAL clff
      REAL cdtot_g
      REAL cltot_a
      REAL cdref
      REAL cltot_d
      REAL clff_d
      REAL cntot_d
      REAL dcm_u0
      REAL cltot_g
      REAL beta
      REAL clff_g
      REAL cdff
      REAL cntot_g
      REAL alfa
      REAL crtot_d
      REAL dtimed
      REAL zsym
      REAL pi
      REAL crtot_g
      REAL cdtot_u
      REAL srcore
      REAL dcl_u0
      REAL chinge_d
      REAL cxtot_d
      REAL cztot_d
      REAL chinge_g
      REAL cxtot_g
      REAL cztot_g
      REAL cltot_u
      REAL crtot
      REAL ysym
      REAL clff_u
      REAL cntot_u
      REAL spanef_a
      REAL spanef
      REAL crtot_u
      REAL spanef_d
      REAL crsax
      REAL spanef_g
      REAL chinge
      REAL cref
      REAL chinge_u
      REAL cxtot_u
      REAL cdref0
      REAL deldes
C AVL version number
C 3.14159/180 ,  3.14159
C y- and z-locations of symmetry planes
C alpha, beta
C freestream velocies in body axes
C d(Vinf)/d(alpha)
C d(Vinf)/d(beta)
C rotation rates in body axes
C time step for eigenmode movie integration
C parameter values for run cases
C imposed constraint value
C imposed control variable value
C imposed design  variable value
C Area, Chord, Span  reference values
C X,Y,Z location for moments
C X,Y,Z location for moments (default)
C freestream Mach number
C freestream Mach number (default)
C baseline profile CD
C baseline profile CD (default)
C vortex core radius / chord
C source core radius / body radius
C Trefftz-plane  CL,CY,CDi
C deriv wrt Vinf,Wrot
C deriv wrt control
C deriv wrt design
C span efficiency
C d(SPANEF)/d(alpha)
C d(SPANEF)/d(beta)
C d(SPANEF)/d(control)
C d(SPANEF)/d(design)
C total CD,CL
C total Cx,Cy,Cz
C total Cl,Cm,Cn
C total Cl,Cm,Cn in stability axis
C total viscous CD
C sensitivities wrt alpha
Csens wrt U,W
Csens wrt U,W
Csens wrt U,W
Csens wrt control
Csens wrt control
Csens wrt control
Csens wrt design
Csens wrt design
Csens wrt design
C additional default CL_a, CM_a
C additional default CL_u, CM_u
C x neutral point
      COMMON /case_r/ version, dtr, pi, ysym, zsym, alfa, beta, vinf(3)
     +, vinf_a(3), vinf_b(3), wrot(3), dtimed, parval(ipmax, nrmax), 
     +conval(icmax, nrmax), delcon(ndmax), deldes(ngmax), sref, cref, 
     +bref, xyzref(3), xyzref0(3), mach, mach0, cdref, cdref0, vrcore, 
     +srcore, clff, cyff, cdff, clff_u(numax), cyff_u(numax), cdff_u(
     +numax), clff_d(ndmax), cyff_d(ndmax), cdff_d(ndmax), clff_g(ngmax)
     +, cyff_g(ngmax), cdff_g(ngmax), spanef, spanef_a, spanef_u(numax)
     +, spanef_d(ndmax), spanef_g(ngmax), cdtot, cltot, cxtot, cytot, 
     +cztot, crtot, cmtot, cntot, crsax, cmsax, cnsax, cdvtot, cdtot_a, 
     +cltot_a, cdtot_u(numax), cltot_u(numax), cxtot_u(numax), cytot_u(
     +numax), cztot_u(numax), crtot_u(numax), cmtot_u(numax), cntot_u(
     +numax), cdtot_d(ndmax), cltot_d(ndmax), cxtot_d(ndmax), cytot_d(
     +ndmax), cztot_d(ndmax), crtot_d(ndmax), cmtot_d(ndmax), cntot_d(
     +ndmax), cdtot_g(ngmax), cltot_g(ngmax), cxtot_g(ngmax), cytot_g(
     +ngmax), cztot_g(ngmax), crtot_g(ngmax), cmtot_g(ngmax), cntot_g(
     +ngmax), chinge(ndmax), chinge_u(ndmax, numax), chinge_d(ndmax, 
     +ndmax), chinge_g(ndmax, ngmax), dcl_a0, dcm_a0, dcl_u0, dcm_u0, 
     +xnp
      COMPLEX eval, evec, evaldat
C mode eigenvalue
C mode eigenvector
C mode eigenvalue reference data
      COMMON /case_z/ eval(jemax, nrmax), evec(jemax, jemax, nrmax), 
     +evaldat(jemax, nrmax)
      INTEGER ntlev
      INTEGER ntsteps
      INTEGER itlev
C current time level
C number of stored time levels
C default number of time steps to run
      COMMON /time_i/ itlev, ntlev, ntsteps
      REAL tder
      REAL deltat
      REAL tpard
      REAL tlev
      REAL tpars
      REAL tparv
C integration time step
C time-derivative differencing coefficient
C time values
C scalar parameter time trace
C vector parameter time trace
C control parameter time traces
      COMMON /time_r/ deltat, tder(3), tlev(ntmax), tpars(kptot, ntmax)
     +, tparv(3, kpvtot, ntmax), tpard(ndmax, ntmax)
      REAL rho0
      REAL gee0
      REAL ainer
      REAL amass
      REAL rmass0
      REAL xyzmass0
      REAL riner0
C density, gravity   | from .mass file
C mass centroid      | from .mass file
C real mass          | from .mass file
C real inertia       | from .mass file
C apparent mass/rho     | from geometry
C apparent inertia/rho  | from geometry
      COMMON /mass_r/ rho0, gee0, xyzmass0(3), rmass0, riner0(3, 3), 
     +amass(3, 3), ainer(3, 3)
      LOGICAL lfwake, lfalbe, lfload
C T if surface sheds a wake
C T if surface is to see freestream alpha,beta
C T if surface contributes to overall loads
      COMMON /surf_l/ lfwake(nfmax), lfalbe(nfmax), lfload(nfmax)
      INTEGER nj
      INTEGER nk
      INTEGER ifrst
      INTEGER jfrst
      INTEGER imags
      INTEGER lscomp
C number of elements along span  in surface
C number of elements along chord in surface
C index of first element in surface
C index of first strip in surface
C indicates whether surface is a YDUPlicated one
C logical surface component index
      COMMON /surf_i/ nj(nfmax), nk(nfmax), ifrst(nfmax), jfrst(nfmax), 
     +imags(nfmax), lscomp(nfmax)
      REAL cnsurf
      REAL cxsurf
      REAL crs_d
      REAL crs_g
      REAL cl_srf
      REAL cdvsurf
      REAL crs_u
      REAL cysurf
      REAL cds_a
      REAL cm_srf
      REAL cds_d
      REAL czs_d
      REAL cds_g
      REAL cavesurf
      REAL czs_g
      REAL cd_srf
      REAL cns_d
      REAL cys_d
      REAL cns_g
      REAL ssurf
      REAL cys_g
      REAL czsurf
      REAL cds_u
      REAL cms_d
      REAL czs_u
      REAL cxs_d
      REAL clsurf
      REAL cms_g
      REAL cxs_g
      REAL cls_a
      REAL cns_u
      REAL cls_d
      REAL cys_u
      REAL cls_g
      REAL cmle_srf
      REAL cms_u
      REAL cxs_u
      REAL cmsurf
      REAL cls_u
      REAL crsurf
      REAL vbody
      REAL cf_srf
      REAL cdsurf
C surface CD,CL
C surface Cx,Cy,Cz
C surface Cl,Cm,Cn
C surface viscous CD
      COMMON /surf_r/ cdsurf(nfmax), clsurf(nfmax), cxsurf(nfmax), 
     +cysurf(nfmax), czsurf(nfmax), crsurf(nfmax), cnsurf(nfmax), cmsurf
     +(nfmax), cdvsurf(nfmax), cds_a(nfmax), cls_a(nfmax), cds_u(nfmax, 
     +numax), cls_u(nfmax, numax), cxs_u(nfmax, numax), cys_u(nfmax, 
     +numax), czs_u(nfmax, numax), crs_u(nfmax, numax), cns_u(nfmax, 
     +numax), cms_u(nfmax, numax), cds_d(nfmax, ndmax), cls_d(nfmax, 
     +ndmax), cxs_d(nfmax, ndmax), cys_d(nfmax, ndmax), czs_d(nfmax, 
     +ndmax), crs_d(nfmax, ndmax), cns_d(nfmax, ndmax), cms_d(nfmax, 
     +ndmax), cds_g(nfmax, ngmax), cls_g(nfmax, ngmax), cxs_g(nfmax, 
     +ngmax), cys_g(nfmax, ngmax), czs_g(nfmax, ngmax), crs_g(nfmax, 
     +ngmax), cns_g(nfmax, ngmax), cms_g(nfmax, ngmax), cf_srf(3, nfmax)
     +, cm_srf(3, nfmax), cl_srf(nfmax), cd_srf(nfmax), cmle_srf(nfmax)
     +, ssurf(nfmax), cavesurf(nfmax), vbody(nbmax)
C      !start added variables for python geometry minipulation
      LOGICAL ldupl_b
C T if surface is a duplicated
      COMMON /body_geom_l/ ldupl_b(nbmax)
      INTEGER nsec_b
C
C number of sections in surface
      COMMON /body_geom_i/ nsec_b(nbmax)
      REAL xyzles_b
      REAL xyztran_b
      REAL xyzscal_b
      REAL ydupl_b
C scaling factors for XYZ coordinates
C translation factors for XYZ coordinates
C y duplicate
C leading edge cordinate vector
      COMMON /body_geom_r/ xyzscal_b(3, nbmax), xyztran_b(3, nbmax), 
     +ydupl_b(nbmax), xyzles_b(3, nsmax, nbmax)
C
      LOGICAL ldupl
C T if surface is a duplicated
      COMMON /surf_geom_l/ ldupl(nfmax)
      INTEGER nsdes
      INTEGER icontd
      INTEGER nsec
      INTEGER idestd
      INTEGER nspans
      INTEGER nscon
      INTEGER nvc
      INTEGER nasec
      INTEGER nvs
C number of sections in surface
C number of chordwise elements
C number of spanwise elements
C number of spanwise elements vector
C control variable index
C number of control variables
C design variable index
C number of design variables
      COMMON /surf_geom_i/ nsec(nfmax), nvc(nfmax), nvs(nfmax), nspans(
     +nsmax, nfmax), nasec(nsmax, nfmax), icontd(iconx, nsmax, nfmax), 
     +nscon(nsmax, nfmax), idestd(iconx, nsmax, nfmax), nsdes(nsmax, 
     +nfmax)
      REAL xyzles
      REAL gaind
      REAL claf
      REAL chords
      REAL gaing
      REAL tasec
      REAL clcdsec
      REAL sspaces
      REAL cspace
      REAL refld
      REAL xhinged
      REAL ydupl
      REAL sspace
      REAL addinc
      REAL xyzscal
      REAL xyztran
      REAL aincs
      REAL sasec
      REAL vhinged
      REAL xasec
C scaling factors for XYZ coordinates
C translation factors for XYZ coordinates
C y position of duplicate plane
C additional incidence angle
C chordwise spacing
C spanwise spacing
C spanwise spacing vector
C leading edge cordinate vector
C chord length vectorm
C incidence angle vector
C the x coordinate aifoil section
C slope of camber line at xasec
C thickness at xasec
C hinge location
C hinge vector
C control surface gain
C control surface reflection
C desgin variable gain
      COMMON /surf_geom_r/ xyzscal(3, nfmax), xyztran(3, nfmax), ydupl(
     +nfmax), addinc(nfmax), cspace(nfmax), sspace(nfmax), sspaces(nsmax
     +, nfmax), xyzles(3, nsmax, nfmax), chords(nsmax, nfmax), aincs(
     +nsmax, nfmax), xasec(ibx, nsmax, nfmax), sasec(ibx, nsmax, nfmax)
     +, tasec(ibx, nsmax, nfmax), clcdsec(6, nsmax, nfmax), claf(nsmax, 
     +nfmax), xhinged(iconx, nsmax, nfmax), vhinged(3, iconx, nsmax, 
     +nfmax), gaind(iconx, nsmax, nfmax), refld(iconx, nsmax, nfmax), 
     +gaing(iconx, nsmax, nfmax)
      INTEGER ijfrst
      INTEGER nsurfs
      INTEGER nvstrp
C      !!--- end added variables for python geometry minipulation ---
C index of surface which contains this strip
C index of first element in strip
C number of elements in strip
      COMMON /strp_i/ nsurfs(nsmax), ijfrst(nsmax), nvstrp(nsmax)
      LOGICAL lstripoff, lviscstrp, lj1sect, lj2sect
C T if strip is "turned off" (outside of fluid)
C T is strip has viscous drag data
C T if station 1 is a section
C T if station 2 is a section
      COMMON /strp_l/ lstripoff(nsmax), lviscstrp(nsmax), lj1sect(nsmax)
     +, lj2sect(nsmax)
      REAL czst_d
      REAL czstrp
      REAL rle
      REAL czst_g
      REAL clst_a
      REAL cmle
      REAL clst_d
      REAL clstrp
      REAL cd_lstrp
      REAL clst_g
      REAL zsref
      REAL cdv_lstrp
      REAL czst_u
      REAL cnrmstrp
      REAL tanle
      REAL clst_u
      REAL cmst_d
      REAL cmstrp
      REAL cmst_g
      REAL crst_d
      REAL cltstrp
      REAL crstrp
      REAL clastrp
      REAL crst_g
      REAL cdst_a
      REAL saxfr
      REAL cdst_d
      REAL cdstrp
      REAL caxlstrp
      REAL ainc
      REAL ess
      REAL chord1
      REAL cdst_g
      REAL chord2
      REAL rle1
      REAL rle2
      REAL cm_strp
      REAL cmst_u
      REAL cnc
      REAL chord
      REAL cnst_d
      REAL crst_u
      REAL cnstrp
      REAL cnst_g
      REAL ainc_g
      REAL cdst_u
      REAL cxst_d
      REAL cxstrp
      REAL cxst_g
      REAL cl_lstrp
      REAL wstrip
      REAL cnst_u
      REAL clcd
      REAL dwwake
      REAL tante
      REAL xsref
      REAL cnc_d
      REAL cnc_g
      REAL cxst_u
      REAL cmc4
      REAL cyst_d
      REAL cystrp
      REAL cyst_g
      REAL cf_strp
      REAL ensy
      REAL ensz
      REAL cnc_u
      REAL ysref
      REAL cyst_u
C strip c.p. line LE point, chord
C strip left  end LE point, chord
C strip right end LE point, chord
C strip y-z width
C strip LE,TE sweep slopes
C strip viscous polar
C x/c of spanwise axis for Vperp def
C spanwise unit vector for Vperp def
C strip normal vector in Trefftz-Pln
C strip's incidence twist angle
C dAINC/dG
C strip forces
C strip forces
C strip moments
C alpha sens.
C strip forces, norm local
      COMMON /strp_r/ rle(3, nsmax), chord(nsmax), rle1(3, nsmax), 
     +chord1(nsmax), rle2(3, nsmax), chord2(nsmax), wstrip(nsmax), tanle
     +(nsmax), tante(nsmax), clcd(numax, nsmax), saxfr, ess(3, nsmax), 
     +ensy(nsmax), ensz(nsmax), xsref(nsmax), ysref(nsmax), zsref(nsmax)
     +, ainc(nsmax), ainc_g(nsmax, ngmax), cdstrp(nsmax), clstrp(nsmax)
     +, cxstrp(nsmax), cystrp(nsmax), czstrp(nsmax), crstrp(nsmax), 
     +cnstrp(nsmax), cmstrp(nsmax), cdst_a(nsmax), clst_a(nsmax), cdst_u
     +(nsmax, numax), clst_u(nsmax, numax), cxst_u(nsmax, numax), cyst_u
     +(nsmax, numax), czst_u(nsmax, numax), crst_u(nsmax, numax), cnst_u
     +(nsmax, numax), cmst_u(nsmax, numax), cdst_d(nsmax, ndmax), clst_d
     +(nsmax, ndmax), cxst_d(nsmax, ndmax), cyst_d(nsmax, ndmax), czst_d
     +(nsmax, ndmax), crst_d(nsmax, ndmax), cnst_d(nsmax, ndmax), cmst_d
     +(nsmax, ndmax), cdst_g(nsmax, ngmax), clst_g(nsmax, ngmax), cxst_g
     +(nsmax, ngmax), cyst_g(nsmax, ngmax), czst_g(nsmax, ngmax), crst_g
     +(nsmax, ngmax), cnst_g(nsmax, ngmax), cmst_g(nsmax, ngmax), 
     +cf_strp(3, nsmax), cm_strp(3, nsmax), cnrmstrp(nsmax), caxlstrp(
     +nsmax), cd_lstrp(nsmax), cl_lstrp(nsmax), cdv_lstrp(nsmax), 
     +cltstrp(nsmax), clastrp(nsmax), cmc4(nsmax), cmle(nsmax), cnc(
     +nsmax), dwwake(nsmax), cnc_u(nsmax, numax), cnc_d(nsmax, ndmax), 
     +cnc_g(nsmax, ngmax)
C
      LOGICAL lvnc, lvalbe
C T if V.n=0 is to be enforced for this c.p.
C T if c.p. is to see freestream alpha,beta
      COMMON /vrtx_l/ lvnc(nvmax), lvalbe(nvmax)
      INTEGER nsurfv
C index of surface which contains vortex element
      COMMON /vrtx_i/ nsurfv(nvmax)
      REAL slopec
      REAL gam_u
      REAL dcp_u
      REAL wvsrd_u
      REAL chordv
      REAL enc_d
      REAL enc_g
      REAL slopev
      REAL rc
      REAL dxv
      REAL wcsrd_u
      REAL gam_u_0
      REAL rl
      REAL dbl
      REAL src
      REAL rs
      REAL rv
      REAL phinge
      REAL rv1
      REAL rv2
      REAL vhinge
      REAL dbl_u
      REAL enc
      REAL env_d
      REAL env_g
      REAL dcp
      REAL vrefl
      REAL gam_d
      REAL dcp_d
      REAL gam_g
      REAL dcp_g
      REAL env
      REAL src_u
      REAL gam_u_d
      REAL gam_u_g
      REAL dcontrol
      REAL gam
      REAL radl
C h.v. vortex left  points
C h.v. vortex right points
C h.v. vortex center points
C h.v. control points
C h.v. source points
C source line node points, body radius
C chord of element
C chord of element-containing strip
C camber slopes at h.v. bound leg
C camber slopes at c.p.
C d(normal angle)/dCONTROL
C hinge vector for CONTROL rot. of normal
C point on hingeline for hinge moment calculation
Csign applied to hinge vec. of refl. surface
C c.p. normal vector
C h.v. normal vector
C sensitivities
C delta(Cp) on vortex element
C circulation of h.v. vortex
C source  strength of source+doublet line elem
C doublet strength of source+doublet line elem
      COMMON /vrtx_r/ rv1(3, nvmax), rv2(3, nvmax), rv(3, nvmax), rc(3, 
     +nvmax), rs(3, nvmax), rl(3, nlmax), radl(nlmax), dxv(nvmax), 
     +chordv(nvmax), slopev(nvmax), slopec(nvmax), dcontrol(nvmax, ndmax
     +), vhinge(3, nsmax, ndmax), phinge(3, nsmax, ndmax), vrefl(nsmax, 
     +ndmax), enc(3, nvmax), env(3, nvmax), enc_d(3, nvmax, ndmax), 
     +enc_g(3, nvmax, ngmax), env_d(3, nvmax, ndmax), env_g(3, nvmax, 
     +ngmax), dcp(nvmax), dcp_u(nvmax, numax), dcp_d(nvmax, ndmax), 
     +dcp_g(nvmax, ngmax), gam(nvmax), gam_u_0(nvmax, numax), gam_u_d(
     +nvmax, numax, ndmax), gam_u_g(nvmax, numax, ngmax), gam_u(nvmax, 
     +numax), gam_d(nvmax, ndmax), gam_g(nvmax, ngmax), src(nlmax), dbl(
     +3, nlmax), src_u(nlmax, numax), dbl_u(3, nlmax, numax), wcsrd_u(3
     +, nvmax, numax), wvsrd_u(3, nvmax, numax)
      INTEGER nl
      INTEGER lfrst
C
C number of source-line nodes in body
C index of first line node in body
      COMMON /body_i/ nl(nbmax), lfrst(nbmax)
      REAL clbdy
      REAL dcpb
      REAL srfbdy
      REAL elbdy
      REAL crbdy
      REAL cdbdy
      REAL czbdy
      REAL volbdy
      REAL cnbdy
      REAL cybdy
      REAL cmbdy
      REAL cxbdy
C body length
C body surface area
C body volume
C dCp loading on sources
C body CD,CL
C body CX,CY,CZ
C body Cl,Cm,Cn
      COMMON /body_r/ elbdy(nbmax), srfbdy(nbmax), volbdy(nbmax), dcpb(3
     +, nlmax), cdbdy(nbmax), clbdy(nbmax), cxbdy(nbmax), cybdy(nbmax), 
     +czbdy(nbmax), crbdy(nbmax), cnbdy(nbmax), cmbdy(nbmax)
      INTEGER iapiv
C
C pivot indices for LU solver
      COMMON /solv_i/ iapiv(nvmax)
      REAL wv
      REAL aicn
      REAL wc_d
      REAL wc_g
      REAL wc_u
      REAL amach
      REAL wv_d
      REAL wv_g
      REAL wc
      REAL wv_u
      REAL wv_gam
      REAL wc_gam
C Mach number at which AIC matrices were computed
C normalwash AIC matrix (and VL system matrix)
C c.p. velocity/Gamma influence matrix
C h.v. velocity/Gamma influence matrix
C total induced velocity at c.p.
C total induced velocity at h.v.
      COMMON /solv_r/ amach, aicn(nvmax, nvmax), wc_gam(3, nvmax, nvmax)
     +, wv_gam(3, nvmax, nvmax), wc(3, nvmax), wc_u(3, nvmax, numax), 
     +wc_d(3, nvmax, ndmax), wc_g(3, nvmax, ngmax), wv(3, nvmax), wv_u(3
     +, nvmax, numax), wv_d(3, nvmax, ndmax), wv_g(3, nvmax, ngmax)
C
      LOGICAL lwakeplt, lloadplt, lhingeplt, lboundleg, lchordline, 
     +        lcamber, lcntlpts, lnrmlplt, laxesplt, lrrefplt, lclperplt
     +        , ldwashplt, llabsurf, ltrforce, label_surf, label_strp, 
     +        label_vrtx, label_body, lpltnew, lpltsurf, lpltbody, 
     +        lsvmov
C plotting flags
      COMMON /plot_l/ lwakeplt, lloadplt, lhingeplt, lboundleg, 
     +lchordline, lcamber, lcntlpts, lnrmlplt, laxesplt, lrrefplt, 
     +lclperplt, ldwashplt, llabsurf, ltrforce, label_surf, label_strp, 
     +label_vrtx, label_body, lpltnew, lpltsurf(nfmax), lpltbody(nbmax)
     +, lsvmov
      INTEGER naxann
      INTEGER ntri
      INTEGER ircolor
      INTEGER imarksurf
      COMMON /plot_i/ ntri, imarksurf, naxann(3), ircolor(nrmax)
      REAL eigenf
      REAL gminp
      REAL vmax
      REAL tri
      REAL vminp
      REAL slomof
      REAL gmaxp
      REAL axmax
      REAL tmofac
      REAL dtmovie
      REAL vmaxp
      REAL gmax
      REAL vmin
      REAL ephase
      REAL tmovie
      REAL axmin
      REAL axspan
      REAL gmin
      REAL axdel
      COMMON /plot_r/ tri(16, itmax), axmin(3), axmax(3), axdel(3), 
     +axspan(3), gmin(3), gmax(3), gminp(3), gmaxp(3), vmin(3), vmax(3)
     +, vminp(3), vmaxp(3), dtmovie, tmovie, slomof, ephase, eigenf, 
     +tmofac
      REAL cnsurfd(nfmax)
      REAL vinf_ad(3)
      REAL vinf_bd(3)
      REAL rled(3, nsmax)
      REAL clst_ad(nsmax)
      REAL clbdyd(nbmax)
      REAL clst_dd(nsmax, ndmax)
      REAL clstrpd(nsmax)
      REAL crs_dd(nfmax, ndmax)
      REAL cmtot_dd(ndmax)
      REAL cntotd
      REAL cytotd
      REAL clst_ud(nsmax, numax)
      REAL cmst_dd(nsmax, ndmax)
      REAL cmstrpd(nsmax)
      REAL crs_ud(nfmax, numax)
      REAL cmtotd
      REAL cysurfd(nfmax)
      REAL cytot_dd(ndmax)
      REAL crst_dd(nsmax, ndmax)
      REAL crstrpd(nsmax)
      REAL cmtot_ud(numax)
      REAL cltotd
      REAL wrotd(3)
      REAL cmst_ud(nsmax, numax)
      REAL chordd(nsmax)
      REAL cnst_dd(nsmax, ndmax)
      REAL cns_dd(nfmax, ndmax)
      REAL cytot_ud(numax)
      REAL crst_ud(nsmax, numax)
      REAL cnstrpd(nsmax)
      REAL cys_dd(nfmax, ndmax)
      REAL crbdyd(nbmax)
      REAL xyzrefd(3)
      REAL vinfd(3)
      REAL cms_dd(nfmax, ndmax)
      REAL clsurfd(nfmax)
      REAL rv1d(3, nvmax)
      REAL rv2d(3, nvmax)
      REAL cls_ad(nfmax)
      REAL wstripd(nsmax)
      REAL cnst_ud(nsmax, numax)
      REAL cns_ud(nfmax, numax)
      REAL cltot_ad
      REAL cls_dd(nfmax, ndmax)
      REAL cys_ud(nfmax, numax)
      REAL cltot_dd(ndmax)
      REAL cntot_dd(ndmax)
      REAL betad
      REAL alfad
      REAL cms_ud(nfmax, numax)
      REAL crtot_dd(ndmax)
      REAL cyst_dd(nsmax, ndmax)
      REAL cmsurfd(nfmax)
      REAL cystrpd(nsmax)
      REAL cls_ud(nfmax, numax)
      REAL crsurfd(nfmax)
      REAL cltot_ud(numax)
      REAL crtotd
      REAL ensyd(nsmax)
      REAL cnbdyd(nbmax)
      REAL enszd(nsmax)
      REAL cntot_ud(numax)
      REAL cybdyd(nbmax)
      REAL crtot_ud(numax)
      REAL cmbdyd(nbmax)
      REAL cyst_ud(nsmax, numax)
      REAL gamd(nvmax)
      COMMON /body_r_d/ clbdyd, cybdyd, crbdyd, cnbdyd, cmbdyd
      COMMON /vrtx_r_d/ rv1d, rv2d, gamd
      COMMON /strp_r_d/ rled, chordd, wstripd, ensyd, enszd, clstrpd, 
     +cystrpd, crstrpd, cnstrpd, cmstrpd, clst_ad, clst_ud, cyst_ud, 
     +crst_ud, cnst_ud, cmst_ud, clst_dd, cyst_dd, crst_dd, cnst_dd, 
     +cmst_dd
      COMMON /surf_r_d/ clsurfd, cysurfd, crsurfd, cnsurfd, cmsurfd, 
     +cls_ad, cls_ud, cys_ud, crs_ud, cns_ud, cms_ud, cls_dd, cys_dd, 
     +crs_dd, cns_dd, cms_dd
      COMMON /case_r_d/ alfad, betad, cltotd, vinfd, vinf_ad, vinf_bd, 
     +xyzrefd, wrotd, cytotd, crtotd, cmtotd, cntotd, cltot_ad, 
     +cltot_ud, cytot_ud, crtot_ud, cmtot_ud, cntot_ud, cltot_dd, 
     +cytot_dd, crtot_dd, cmtot_dd, cntot_dd
      REAL delcond(ndmax)

